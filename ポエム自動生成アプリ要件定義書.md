# 要件定義書

## プロジェクト概要

本プロジェクトは、写真やキャラクター情報を元にポエムを自動生成するツールを開発します。  
Hugging Face APIを活用し、以下2種類のポエム生成機能を提供します：

1. アップロードされた画像の雰囲気を解析して生成。
2. ユーザーが提供したキャラクター情報を基に生成。  

ユーザーが生成されたポエムを評価する機能も提供し、SNSでの共有も可能です。

---

## 1. システム概要

### 1.1 ユーザー層

- 写真投稿を行うSNSユーザー
- キャラクタークリエイターやファンコミュニティのメンバー

### 1.2 主な機能

1. **写真アップロード機能**  
   - ユーザーが自身の写真をアップロードできる。
   - react-dropzoneを使用したドラッグ＆ドロップ機能
   - プレビュー表示機能

2. **ポエム自動生成機能**  
   - 以下の2種類の生成方法を提供：
     1. **画像の雰囲気から生成**  
        - アップロードされた写真の雰囲気をAIが解析し、ポエムを生成。
     2. **キャラクター情報から生成**  
        - ユーザーが提供したキャラクター情報（名前、特徴、セリフなど）を基にポエムを生成。

3. **ポエム評価機能**  
   - 生成されたポエムに対して、ユーザーが「良い」「悪い」で評価可能。

4. **ポエムのカスタマイズ機能**  
   - ユーザーが生成されたポエムを編集できる。

5. **SNS連携機能**  
   - 生成されたポエムと写真をSNSに直接投稿可能。

6. **言語選択機能**  
   - 日本語、英語、中国語、韓国語に対応。

---

## 2. フロントエンド

### 2.1 技術スタック

- **フレームワーク**: React
- **スタイリング**: Material-UI
- **状態管理**: Context API
- **ルーティング**: React Router v6

### 2.2 UI要件

1. **写真アップロード画面**
   - ドラッグ＆ドロップ機能（react-dropzone）
   - アップロードした写真のプレビュー
   - アップロードボタン

2. **ポエム生成画面**
   - 画像の雰囲気から生成されたポエムの表示
   - キャラクター情報から生成されたポエムの表示
   - ポエム評価機能（「良い」「悪い」のボタン）
   - 編集機能
   - SNS共有機能

3. **キャラクター情報入力画面**
   - キャラクター名、作品名、特徴、セリフを入力するフォーム
   - 入力内容のバリデーション

---

## 3. バックエンド

### 3.1 技術スタック

- **フレームワーク**: FastAPI
- **AIモデル**: Hugging Face API（cyberagent/open-calm-7b）
- **ファイル処理**: Python-multipart

### 3.2 主なAPIエンドポイント

1. `/upload-photo` (POST)  
   - 写真をアップロードし、ローカルストレージに保存。

2. `/submit-character` (POST)  
   - ユーザーが提供したキャラクター情報を保存。

3. `/generate-poem` (POST)  
   - 以下2種類のポエム生成を実行：
     - 写真の雰囲気から生成。
     - キャラクター情報から生成。

4. `/customize-poem` (PUT)  
   - ユーザーが編集したポエムを保存。

5. `/share-on-sns` (POST)  
   - SNS投稿用データを生成。

---

## 4. デプロイメント

### 4.1 フロントエンド

- **ホスティング**: Vercel
- **ビルド設定**: Create React App
- **環境変数**: REACT_APP_API_URL

### 4.2 バックエンド

- **ホスティング**: Render
- **環境変数**: HUGGINGFACE_API_KEY

---

## 5. セキュリティ要件

### 5.1 CORS設定

- 許可するオリジン:
  - http://localhost:3000
  - https://poemgenerator-i3v6iijhh-suyako-tecks-projects.vercel.app
  - https://poem-generator-app.vercel.app

### 5.2 ファイルアップロード制限

- 許可するファイル形式: jpeg, jpg, png
- 最大ファイルサイズ: 5MB

---

## 6. エラーハンドリング

### 6.1 フロントエンド

- アップロードエラー
- 生成エラー
- ネットワークエラー

### 6.2 バックエンド

- ファイル処理エラー
- API呼び出しエラー
- バリデーションエラー

---

## 7. パフォーマンス要件

### 7.1 フロントエンド

- 画像の最適化
- コンポーネントの遅延ロード
- キャッシュの活用

### 7.2 バックエンド

- 非同期処理
- エラーログの記録
- レスポンスの最適化

---
